# 📊 요약 시트 구현 완료!

ending focast.xlsx 파일의 **"요약" 시트**에 있는 **상권별, team별, 유통별, 순수별, 단체별** 데이터가 대시보드에 구현되었습니다!

---

## ✨ 새로운 기능

### 📈 요약 탭 추가
대시보드에 **4번째 탭**이 추가되었습니다:
1. 📊 개요
2. **📈 요약 (상권/팀/유통)** ← 새로 추가!
3. 🔮 예측
4. 📋 상세

### 📊 5개 카테고리 분석
- **상권별** 데이터 (바 차트)
- **Team별** 데이터 (바 차트)
- **유통별** 데이터 (바 차트)
- **순수별** 데이터 (바 차트)
- **단체별** 데이터 (바 차트)

### 🎨 시각화
- 각 카테고리별 요약 카드
- 인터랙티브 바 차트
- 전체 데이터 테이블 (검색/정렬/페이지네이션)
- 차트 ↔ 테이블 전환 버튼

---

## 🚀 실행 방법

### 1단계: 요약 시트 분석

**`analyze-summary.bat` 파일을 더블클릭**

이 스크립트가 자동으로:
- ✅ "요약" 시트 찾기
- ✅ 상권별/team별/유통별/순수별/단체별 컬럼 자동 인식
- ✅ 데이터 추출 및 집계
- ✅ `summary-sheet-analysis.json` 파일 생성

또는 터미널에서:
```bash
npm run analyze-summary
```

### 2단계: 분석 결과 확인

`summary-sheet-analysis.json` 파일을 열어서:
- 어떤 컬럼이 발견되었는지 확인
- 각 카테고리의 데이터 개수 확인
- 샘플 데이터 확인

### 3단계: 서버 실행

```bash
npm run dev
```

또는 `start.bat` 파일 실행

### 4단계: 대시보드 확인

브라우저에서:
```
http://localhost:3000
```

**📈 요약 (상권/팀/유통)** 탭을 클릭하세요!

---

## 📋 자동 인식되는 컬럼명

### 상권별
```
상권, 商圈, Area, District, Zone
```

### team별
```
team, Team, TEAM, 팀, チーム
```

### 유통별
```
유통, 流通, Distribution, Channel
```

### 순수별
```
순수, 純粋, Pure, Net
```

### 단체별
```
단체, 團體, Group, Organization
```

💡 **주의**: 엑셀 파일의 실제 컬럼명이 다르다면 자동으로 감지하지 못할 수 있습니다.

---

## 🔧 컬럼명이 다른 경우

### 1. 분석 결과 확인
```bash
npm run analyze-summary
```

`summary-sheet-analysis.json` 파일에서 실제 컬럼명을 확인하세요.

### 2. 코드 수정

`lib/summaryReader.ts` 파일의 `extractCategoryData` 함수에서 키워드를 추가:

```typescript
// 예: "지역" 컬럼이 있다면
const categoryColumn = columns.find(col =>
  keywords.some(keyword => col.includes(keyword)) ||
  col.includes('지역')  // ← 추가
);
```

### 3. 서버 재시작
```bash
npm run dev
```

---

## 📊 표시되는 데이터

### 요약 카드
각 카테고리별로:
- 총 합계
- 항목 개수
- 아이콘 및 색상

### 바 차트
- X축: 카테고리명 (상권, 팀, 유통 등)
- Y축: 값 (금액, 수량 등)
- 상위 20개 항목만 표시
- 인터랙티브 툴팁

### 데이터 테이블
- 전체 원본 데이터
- 검색 기능
- 정렬 기능
- 페이지네이션 (20개씩)

---

## 🎨 UI 구성

### 카테고리 요약 카드 (5개)
```
┌─────────────┬─────────────┬─────────────┬─────────────┬─────────────┐
│  상권별     │   Team별    │   유통별    │   순수별    │   단체별    │
│  📍 95개   │  👥 12개   │  📦 8개    │  🏅 15개   │  🏢 23개   │
└─────────────┴─────────────┴─────────────┴─────────────┴─────────────┘
```

### 차트/테이블 전환
```
[📊 차트]  [📋 테이블]  ← 토글 버튼
```

### 바 차트 레이아웃
```
┌───────────────────────────┬───────────────────────────┐
│     상권별 분석           │      Team별 분석          │
├───────────────────────────┼───────────────────────────┤
│     유통별 분석           │      순수별 분석          │
├───────────────────────────┼───────────────────────────┤
│     단체별 분석           │                          │
└───────────────────────────┴───────────────────────────┘
```

---

## 📝 구현된 파일 목록

### 새로 추가된 파일 (6개)

1. **`analyze-summary-sheet.js`**
   - "요약" 시트 전용 분석 스크립트
   - 5개 카테고리 자동 감지
   - JSON 결과 파일 생성

2. **`analyze-summary.bat`**
   - 원클릭 실행 스크립트
   - xlsx 설치 확인 및 분석

3. **`lib/summaryReader.ts`**
   - 요약 시트 데이터 읽기
   - 카테고리 자동 추출
   - 데이터 집계 및 변환

4. **`components/SummaryDashboard.tsx`**
   - 요약 탭 메인 컴포넌트
   - 5개 카테고리 카드
   - 차트/테이블 전환

5. **`components/CategoryChart.tsx`**
   - 재사용 가능한 차트 컴포넌트
   - 바 차트 / 파이 차트 지원
   - 데이터 요약 표시

6. **`요약시트_구현완료.md`**
   - 이 가이드 문서

### 수정된 파일 (4개)

1. **`app/api/dashboard/route.ts`**
   - summaryReader 통합
   - 요약 데이터 포함

2. **`components/EnhancedDashboard.tsx`**
   - 요약 탭 추가
   - SummaryDashboard 컴포넌트 통합

3. **`types/dashboard.ts`**
   - summarySheet 타입 추가

4. **`package.json`**
   - analyze-summary 스크립트 추가

---

## 🔍 데이터 흐름

```
ending focast.xlsx
      ↓
  [요약 시트]
      ↓
summaryReader.ts
  (자동 감지)
      ↓
  - 상권별 컬럼 → byArea[]
  - team별 컬럼 → byTeam[]
  - 유통별 컬럼 → byChannel[]
  - 순수별 컬럼 → byPure[]
  - 단체별 컬럼 → byGroup[]
      ↓
API Response
      ↓
SummaryDashboard
      ↓
CategoryChart (x5)
  (시각화)
```

---

## 💡 사용 예시

### 1. 상권별 매출 분석
```
강남: ₩150,000,000
홍대: ₩120,000,000
강북: ₩95,000,000
...
```

### 2. Team별 실적
```
Team A: 850건
Team B: 720건
Team C: 680건
...
```

### 3. 유통별 판매
```
온라인: 45%
오프라인: 35%
도매: 20%
```

---

## ⚠️ 문제 해결

### 문제 1: "요약 시트를 찾을 수 없습니다"

**원인**: 시트 이름이 "요약"이 아님

**해결**:
1. 엑셀 파일을 열어서 시트 이름 확인
2. `lib/summaryReader.ts`의 `summarySheetNames` 배열에 실제 시트 이름 추가

```typescript
const summarySheetNames = ['요약', 'Summary', '실제시트명'];
```

### 문제 2: "데이터가 표시되지 않습니다"

**원인**: 컬럼명이 자동 인식되지 않음

**해결**:
1. `npm run analyze-summary` 실행
2. `summary-sheet-analysis.json` 확인
3. 실제 컬럼명을 `lib/summaryReader.ts`에 추가

### 문제 3: "카테고리가 비어있습니다"

**원인**: 값 컬럼을 찾지 못함

**해결**:
`lib/summaryReader.ts`의 `valueColumns` 배열에 실제 컬럼명 추가:

```typescript
const valueColumns = columns.filter(col =>
  col.includes('금액') || 
  col.includes('실제컬럼명')  // ← 추가
);
```

---

## 🎉 완성!

이제 다음을 실행하세요:

```bash
# 1. 요약 시트 분석
analyze-summary.bat

# 2. 서버 실행
npm run dev

# 3. 브라우저에서 확인
http://localhost:3000
```

**📈 요약 (상권/팀/유통)** 탭에서 5개 카테고리의 데이터를 확인하세요!

---

## 📞 추가 도움말

- 전체 가이드: `DASHBOARD_UPGRADE.md`
- 엑셀 연동: `EXCEL_SETUP_GUIDE.md`
- 시작하기: `시작하기.txt`

궁금한 점이 있으면 언제든 물어보세요! 🚀


